<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1.0' />
  <meta http-equiv='x-ua-compatible' content='ie=edge' />
  <title>Demo</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@thtf/spreadsheet-designer-core/dist/styles/spreadsheet.css">
  <script src="https://cdn.jsdelivr.net/npm/@thtf/spreadsheet-designer-core/dist/js/spreadsheet.min.js"></script>
</head>

<body onload='load()'>
<div id='root'></div>
<script src='./public/demo-data.js'></script>
<script src='./public/extend-data.js'></script>
<script src='./public/big-data.js'></script>
<script src='./public/public-data.js'></script>
<script>
  function load() {
    // 1
    const saveIcon = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTc3MTc3MDkyOTg4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI2NzgiIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTIxMy4zMzMzMzMgMTI4aDU5Ny4zMzMzMzRhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMSA4NS4zMzMzMzMgODUuMzMzMzMzdjU5Ny4zMzMzMzRhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMS04NS4zMzMzMzMgODUuMzMzMzMzSDIxMy4zMzMzMzNhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMS04NS4zMzMzMzMtODUuMzMzMzMzVjIxMy4zMzMzMzNhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMSA4NS4zMzMzMzMtODUuMzMzMzMzeiBtMzY2LjkzMzMzNCAxMjhoMzQuMTMzMzMzYTI1LjYgMjUuNiAwIDAgMSAyNS42IDI1LjZ2MTE5LjQ2NjY2N2EyNS42IDI1LjYgMCAwIDEtMjUuNiAyNS42aC0zNC4xMzMzMzNhMjUuNiAyNS42IDAgMCAxLTI1LjYtMjUuNlYyODEuNmEyNS42IDI1LjYgMCAwIDEgMjUuNi0yNS42ek0yMTMuMzMzMzMzIDIxMy4zMzMzMzN2NTk3LjMzMzMzNGg1OTcuMzMzMzM0VjIxMy4zMzMzMzNIMjEzLjMzMzMzM3ogbTEyOCAwdjI1NmgzNDEuMzMzMzM0VjIxMy4zMzMzMzNoODUuMzMzMzMzdjI5OC42NjY2NjdhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMS00Mi42NjY2NjcgNDIuNjY2NjY3SDI5OC42NjY2NjdhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMS00Mi42NjY2NjctNDIuNjY2NjY3VjIxMy4zMzMzMzNoODUuMzMzMzMzek0yNTYgMjEzLjMzMzMzM2g4NS4zMzMzMzMtODUuMzMzMzMzeiBtNDI2LjY2NjY2NyAwaDg1LjMzMzMzMy04NS4zMzMzMzN6IG0wIDU5Ny4zMzMzMzR2LTEyOEgzNDEuMzMzMzMzdjEyOEgyNTZ2LTE3MC42NjY2NjdhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSA0Mi42NjY2NjctNDIuNjY2NjY3aDQyNi42NjY2NjZhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSA0Mi42NjY2NjcgNDIuNjY2NjY3djE3MC42NjY2NjdoLTg1LjMzMzMzM3ogbTg1LjMzMzMzMyAwaC04NS4zMzMzMzMgODUuMzMzMzMzek0zNDEuMzMzMzMzIDgxMC42NjY2NjdIMjU2aDg1LjMzMzMzM3oiIHAtaWQ9IjI2NzkiIGZpbGw9IiMyYzJjMmMiPjwvcGF0aD48L3N2Zz4=';
    // 2
    const previewEl = document.createElement('img');
    previewEl.src = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjIxMzI4NTkxMjQzIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjU2NjMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTEyIDE4Ny45MDRhNDM1LjM5MiA0MzUuMzkyIDAgMCAwLTQxOC41NiAzMTUuNjQ4IDQzNS4zMjggNDM1LjMyOCAwIDAgMCA4MzcuMTIgMEE0MzUuNDU2IDQzNS40NTYgMCAwIDAgNTEyIDE4Ny45MDR6TTUxMiAzMjBhMTkyIDE5MiAwIDEgMSAwIDM4NCAxOTIgMTkyIDAgMCAxIDAtMzg0eiBtMCA3Ni44YTExNS4yIDExNS4yIDAgMSAwIDAgMjMwLjQgMTE1LjIgMTE1LjIgMCAwIDAgMC0yMzAuNHpNMTQuMDggNTAzLjQ4OEwxOC41NiA0ODUuNzZsNC44NjQtMTYuMzg0IDQuOTI4LTE0Ljg0OCA4LjA2NC0yMS41NjggNC4wMzItOS43OTIgNC43MzYtMTAuODggOS4zNDQtMTkuNDU2IDEwLjc1Mi0yMC4wOTYgMTIuNjA4LTIxLjMxMkE1MTEuNjE2IDUxMS42MTYgMCAwIDEgNTEyIDExMS4xMDRhNTExLjQ4OCA1MTEuNDg4IDAgMCAxIDQyNC41MTIgMjI1LjY2NGwxMC4yNCAxNS42OGMxMS45MDQgMTkuMiAyMi41OTIgMzkuMTA0IDMyIDU5Ljc3NmwxMC40OTYgMjQuOTYgNC44NjQgMTMuMTg0IDYuNCAxOC45NDQgNC40MTYgMTQuODQ4IDQuOTkyIDE5LjM5Mi0zLjIgMTIuODY0LTMuNTg0IDEyLjgtNi40IDIwLjA5Ni00LjQ4IDEyLjYwOC00Ljk5MiAxMi45MjhhNTExLjM2IDUxMS4zNiAwIDAgMS0xNy4yOCAzOC40bC0xMi4wMzIgMjIuNC0xMS45NjggMjAuMDk2QTUxMS41NTIgNTExLjU1MiAwIDAgMSA1MTIgODk2YTUxMS40ODggNTExLjQ4OCAwIDAgMS00MjQuNDQ4LTIyNS42bC0xMS4zMjgtMTcuNTM2YTUxMS4yMzIgNTExLjIzMiAwIDAgMS0xOS44NC0zNS4wMDhMNTMuMzc2IDYxMS44NGwtOC42NC0xOC4yNC0xMC4xMTItMjQuMTI4LTcuMTY4LTE5LjY0OC04LjMyLTI2LjYyNC0yLjYyNC05Ljc5Mi0yLjQ5Ni05LjkyeiIgcC1pZD0iNTY2NCI+PC9wYXRoPjwvc3ZnPg==';
    previewEl.width = 16;
    previewEl.height = 16;
    // 3
    const ulEl = document.createElement('ul');
    for (let i = 0; i < 10; i += 1) {
      const liEl = document.createElement('li');
      liEl.innerHTML = `li${i}`;
      ulEl.appendChild(liEl);
    }

    const xs = Spreadsheet('#root', {
      locale: 'zh', // 语言： zh | en      ，默认为zh
      mode: 'edit', // 模式： edit | read |  ，默认为edit
      view: {
        height: () => document.documentElement.clientHeight,
        width: () => document.documentElement.clientWidth,
      },
      showGrid: true, // 是否显示网格，默认为ture
      showToolbar: true, // 是否显示工具栏，默认为ture
      showContextmenu: true, // 是否显示右键菜单，默认为ture
      showBottomBar: true, // 是否显示底部状态栏，默认为ture
      disableToolbar: [], // 禁用工具栏按钮 "paintFormat",'undo', 'redo','format','font','fontSize'
      row: {
        len: 100, // 行数，默认为100
        height: 25, // 行高，默认为25
      },
      col: {
        len: 26, // 列数，默认为26
        width: 100, // 列宽，默认为100
        indexWidth: 60, // 索引列宽度，默认为60
        minWidth: 20, // 最小列宽，默认为60
      },
      extendToolbar: { // 扩展工具栏按钮，在这里将按钮分为三类：icon(可带图标按钮) toggle(可切换状态按钮) dropdown(下拉菜单按钮)
        left: [
          {
            type: 'icon', // 三种按钮类型之一: icon
            tag: 'iconTest', // 可为按钮定义一个名称
            tip: 'icon 型按钮', // 鼠标 hover 提示词
            icon: saveIcon, // 按钮图标 可为 base64 图片
            onClick: (data, sheet) => { // 按钮单击回调方法
              console.log('click save button：', data, sheet);
            },
          },
          {
            type: 'toggle', // 三种按钮类型之一: toggle
            tag: 'toggleTest', // 可为按钮定义一个名称
            tip: 'toggle 型按钮',
            el: previewEl, // 按钮图标，可为一个包含图标的 dom 片段
            onClick: (data, dataObj) => { // 按钮单击回调方法
              console.log('click save button：', data, dataObj);
              console.log('11111', xs.getData(0));
              console.log('22222', xs);
              xs.sheet.data.setCellExtra(11, 1, { 'toggleTest': true });
              xs.sheet.data.setExtraData({ 'ri': 2, 'ci': 15 });
              // xs.sheet.data.setCellStyle(11, 1,{
              //   align: 'center',
              //   bgcolor: 'red'
              // })
              // xs.sheet.setCellRangeTxtAndStyle(17,1,18,2,'测试setCellRangeTxtAndStyle',{
              //   align: 'center',
              //   bgcolor: 'red'
              // })
              // xs.sheet.data.deleteGivenCells([{ri: 0, ci: 0}])
              let arr = xs.sheet.data.getXYByStrCoord('C5');
              xs.sheet.data.insertByCellCoord(5, 3, 'column', 2);
              console.log(arr);
              xs.reRender();
              console.log('33', xs.sheet.data.getData());
            },
          },
          {
            type: 'dropdown', // 三种按钮类型之一: dropdown
            tag: 'dropdownTest', // 可为按钮定义一个名称
            tip: 'dropdown 型按钮',
            width: '200px', // 下拉框宽度
            value: '',
            content: ulEl,// 下拉框显示的内容
            icon: saveIcon, // 下拉框按钮，可为空，为空则使用输入框
            onClick: (data, sheet) => {
              console.log('click save button：', data, sheet);
            },
          },
        ],
        right: [
          // {
          //   type: "icon",
          //   tag: 'iconTest2',
          //   tip: "Preview",
          //   el: previewEl,
          //   onClick: (data, sheet) => {
          //     console.log("click preview button：", data);
          //   }
          // }
        ],
      },
    })
      .loadData([
        EXTEND_DATA,
        DEMO_DATA,
        BIG_DATA,
        PUBLIC_DATA,
      ])
      .change(data => {
        console.log('change: --->', xs.getData());
        console.log('这个 change 方法将注入到实例对象中去，当实例对象的 sheet 触发 change 事件时，就会执行。', data);
        console.log('<---');
      })
      .on('cells-selected', (cell, range) => {
        console.log('cells-selected >>>> cell, range is ', cell, range);
      })
      .on('cell-selected', (cell, rowIndex, colIndex) => {
        if (['radio','checkbox'].includes(cell?.type)) {
          cell.checked = !cell.checked;
        }
        console.log('cell-selected >>>> cell, rowIndex, colIndex is ', cell, rowIndex, colIndex);
      })
      .on('cell-edited', (text, rowIndex, colIndex) => {
        console.log('cell-edited >>>> text, rowIndex, colIndex is ', text, rowIndex, colIndex);
      })
      .on('pasted-clipboard', (data) => {
        console.log('pasted-clipboard >>>> data is ', data);
      });

    console.log(xs);

    setTimeout(() => {
      // xs.loadData([{ rows }]);
      xs.cellText(14, 3, 'cell-text').reRender();
      console.log('cell(8, 8):', xs.cell(8, 8));
      console.log('cellStyle(8, 8):', xs.cellStyle(8, 8));
    }, 5000);
  }
</script>
</body>
</html>
